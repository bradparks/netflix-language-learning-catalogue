<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">

    <title>LLN - Catalogue</title>
    <meta name="description" content="">
    <meta name="author" content="NLLE">
    <link rel="icon" type="image/png" href="logo32.png">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
<style>
    body {
        font-family: 'Open Sans', sans-serif;
        padding: 0;
        margin: 0;
        overflow-y: scroll;
    }
    table, tr, td, th {
        border: 1px solid #ddd;
        border-collapse: collapse;
    }
    td, th {
        padding: 10px;
    }
    .img-wrap {
        min-height: 200px;
        min-width: 1px;
    }
    img {
        max-height: 200px;
    }
    .title {
        font-size: 1.15em;
        font-weight: bold;
        text-decoration: none;
        display: block;
        margin-bottom: 20px;
        color: black;
    }
    .synopsis {
        vertical-align: top;
        padding-top: 30px;
        padding-left: 20px;
    }
    .synopsis-text {
        text-decoration: none;
        color: black;
    }
    .filters {
        margin: 30px 0 20px;
        display: flex;
        align-items: center;
    }
    select {
        padding: 10px 15px;
        margin-right: 10px;
        width: 180px;
    }
    .results-count {
        margin-left: 14px;
    }
    .center {
        text-align: center;
    }
    .mt10 {
        margin-top: 10px;
    }
    .bottom-links {
        margin-top: 30px;
        text-align: right;
    }
    .bottom-links a {
        margin: 0 0 0 10px;
        background: #75a1d0;
        color: white;
        border-radius: 3px;
        padding: 7px 17px;
        text-decoration: none;
        display: inline-block;
        margin-top: 10px;
        margin-bottom: 10px;
    }
    .bottom-links .imdb-link {
        background: #f9bd93;
    }
    .mb {
       margin-bottom: 15px; 
    }
    .small {
        font-size: .8em;
    }
    h1 { font-size: 20px; display: flex; align-items: center; }
    .logo {width: 64px; height: auto; margin-right:10px; }
    .
    [v-cloak] {display: none}
</style>

</head>

<body>

<div style="max-width: 1366px; margin: 0 auto; padding: 0 20px;">

<div id="app">
    <div class="intro">
        <h1>
            <img src="logo.png" alt="logo" class="logo">
            Language Learning with Netflix - Catalogue
        </h1>
        <p>For the best experience, we recommend you use select programs whose original language is the language you are studying. That is to say, look for French films to study French, and German films to study German etc.
</p><p>
The reason for this is that Netflix usually good subtitles for the original language that match the audio track. Subtitles often don't match the audio for dubbed audio.
</p><p>
To help find suitable programs in the language you study, we created a catalogue. You must select the country where Netflix detects you are located, as different programs are available in different countries. You can also select 'All Countries' if you are curious what programs are available in other countries.
</p>
    </div>
    <div class="filters">
        <select v-model.lazy="language" @change="loadLanguageCountry()">
          <option v-for="lang in languages" :value="lang">{{lang}}</option>
        </select>
        <select v-model.lazy="country" @change="loadLanguageCountry()">
          <option value="">All countries</option>
          <option v-for="c in countries" :value="c">{{c}}</option>
        </select>
        <div class="results-count">
            <span v-if="movies.length" style="color: green;">
                Found {{movies.length + (movies.length == 1000 ? '+' : '') }} movies
            </span>
            <span v-if="!loading && movies.length == 0" style="color: red;">
                Couldn't find any movies for selected language and country
            </span>
            <span v-if="loading && movies.length == 0" style="color: green;">
                Loading...
            </span>
        </div>
    </div>

    <table v-if="movies.length" v-cloak>
        <tr>
            <th>Image</th>
            <th>Title &amp; Synopsis</th>
            <th>Info</th>
            <th>Rating</th>
            <th>Availability</th>
        </tr>
        <tr v-for="movie in movies">
            <td class="center">
                <a :href="'https://www.netflix.com/watch/' + movie.netflixid">
                    <div class="img-wrap">
                        <img :src="movie.image"/>
                    </div>
                </a>
            </td>
            <td class="synopsis">
                <a class="title" :href="'https://www.netflix.com/watch/' + movie.netflixid">
                    {{movie.title}}
                </a>
                <a class="synopsis-text" :href="'https://www.netflix.com/watch/' + movie.netflixid">
                    {{movie.synopsis}}
                </a>
                <div class="bottom-links" style="text-align: right; margin-right: 20px;">
                    <a class="imdb-link" v-if="movie.imdbid" :href="'https://www.imdb.com/title/' +  movie.imdbid" target="_blank">IMDB</a>
                    <a :href="'https://www.netflix.com/watch/' + movie.netflixid">
                        Watch on Netflix
                        <span style="margin-left: 10px;">▶</span>
                    </a>
                </div>
            </td>
            <td class="center">
                <div class="mb"><strong>Genre: </strong>{{movie.genre || "unknown"}} <br></div>
                <div class="mb"><strong>Released: </strong>{{movie.released}} <br></div>
                <div class="mb"><strong>Runtime: </strong>{{movie.runtime}}</div>
            </td>
            <td class="center">
                <strong class="mb">{{movie.rating || "unknown"}}</strong><br>
                <span class="small" ng-if="movie.votes">({{movie.votes}} votes)</span>
            </td>
            <td class="center" :title="movie.countries">
                {{(movie.countries || []).length}} countries
            </td>
        </tr>
    </table>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>

<script>
(function(){
'use strict';
    
new Vue({
    el: '#app',
    data: {
        movies: [],
        language: 'English',
        country: '',
        languages: ["Arabic","Bengali","Catalan","Chinese","Croatian","Danish","Dutch","English","Filipino","Finnish","French","Georgian","German","Hebrew","Hindi","Icelandic","Italian","Japanese","Korean","Norwegian","Polish","Portuguese","Russian","Spanish","Swedish","Tamil","Thai","Turkish","Vietnamese"],
        countries: ["Afghanistan","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antarctica","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bonaire, Sint Eustatius and Saba","Bosnia and Herzegovina","Botswana","Brazil","British Indian Ocean Territory","Brunei Darussalam","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Cayman Islands","Central African Republic","Chad","Chile","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Congo, the Democratic Republic of the","Cook Islands","Costa Rica","Cote dIvoire","Croatia","Cuba","Curaçao","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands (Malvinas)","Faroe Islands","Fiji","Finland","France","French Guiana","French Polynesia","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe","Guam","Guatemala","Guernsey","Guinea","Guinea-Bissau","Guyana","Haiti","Heard Island and McDonald Islands","Holy See","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Isle of Man","Israel","Italy","Jamaica","Japan","Jersey","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Lao Peoples Democratic Republic","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macao","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique","Mauritania","Mauritius","Mexico","Micronesia","Moldova, Republic of","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Caledonia","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Palestine, State of","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn","Poland","Portugal","Puerto Rico","Qatar","Republic of the Congo","Romania","Russia","Rwanda","Réunion","Saint Barthélemy","Saint Helena","Saint Kitts and Nevis","Saint Lucia","Saint Martin","Saint Pierre and Miquelon","Saint Vincent","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Sint Maarten (Dutch part)","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and the South Sandwich Islands","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Swaziland","Sweden","Switzerland","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","United States Minor Outlying Islands","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Virgin Islands, British","Virgin Islands, U.S.","Wallis and Futuna","Western Sahara","Yemen","Zambia","Zimbabwe"],
        loading: true
    },
    created: function () {
        var language = this.getHashValue('language');
        if (this.languages.indexOf(language) > -1) this.language = language;
        var country = this.getHashValue('country');
        if (this.countries.indexOf(country) > -1) this.country = country;
        
        this.loadLanguageCountry();
    },
    methods: {
        loadLanguageCountry: function() {
            var that = this;
            this.movies = [];
            this.loading = true;
            this.setHashValue('language', this.language);
            this.setHashValue('country', this.country);
            fetch("filmdata/" + this.language + ".json").then(function(r){
                return r.json();
            }).then(function(json){
                that.movies = json.filter(function(movie){
                    return !that.country || movie.countries.indexOf(that.country) > -1;
                });
                that.loading = false;
            }).catch(function(err) {
                that.movies = [];
                that.loading = false;
                console.error(err)
            });
        },
//      reverseMessage: function () {
//        return this.message.split('').reverse().join('')
//      }
        getHashValue: function (key) {
            var hash = location.hash.match(new RegExp(key + '=([^&]*)'));

            if (location.hash && hash) {
                return decodeURI(hash[1]);
            }

            return null;
        },
        setHashValue: function (key, value) {
            key = encodeURI(key); value = encodeURI(value);

            var kvp = location.hash.substr(1).split('&');
            if (! location.hash) {
                kvp = [];
            }
            var i = kvp.length; var x; while(i--){
                x = kvp[i].split('=');

                if (x[0] == key){
                    x[1] = value;
                    kvp[i] = x.join('=');
                    break;
                }
            }

            if(i < 0) {
                kvp[kvp.length] = [key,value].join('=');
            }

            document.location.hash = '#' + kvp.join('&');
        }
    }
})
    
})();
</script>
</body>
</html>
